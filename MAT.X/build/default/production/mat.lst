MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 ;
                      00002 ; * machine à thé
                      00003 ; * Copyright 2016, Jacques Deschenes
                      00004 ; * 
                      00005 ; * This file is part of machineathe project.
                      00006 ; * 
                      00007 ; * ***  LICENCE ****
                      00008 ; * This program is free software; you can redistribute it and/or modify
                      00009 ; * it under the terms of the GNU General Public License as published by
                      00010 ; * the Free Software Foundation; either version 3 of the License, or
                      00011 ; * (at your option) any later version.
                      00012 ; * 
                      00013 ; * This program is distributed in the hope that it will be useful,
                      00014 ; * but WITHOUT ANY WARRANTY; without even the implied warranty of
                      00015 ; * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
                      00016 ; * GNU General Public License for more details.
                      00017 ; * 
                      00018 ; * You should have received a copy of the GNU General Public License
                      00019 ; * along with this program; See 'copying.txt' in root directory of source.
                      00020 ; * If not, write to the Free Software Foundation,
                      00021 ; * Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301  USA
                      00022 ; *  
                      00023 ; * to contact the author:  jd_temp@yahoo.fr
                      00024 ; * 
                      00025  ;
                      00026 ; MAT
                      00027 ; Machine à Thé.
                      00028 ; Description:  Machine avec minuterie pour le trempage d'un sachet de thé.
                      00029 ;   1 bouton pour réglé la durée en multiple de 15 secondes
                      00030 ;   1 bouton pour le démarrage de la séquence
                      00031 ;   1 servo moteur relié à un levier auquel est attaché le sachet. Le sachet est
                      00032 ;   descendu dans la tasse au début de la séquence et remonter à la fin.
                      00033 ;   1 affichage barre de DEL pour indiqué le temps.
                      00034 ;   1 haut-parleur pour l'arlame indiquant la fin de la séquence.
                      00035 ;
                      00036  
                      00037     include p16f1703.inc
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ; Build date : Sep 13 2016
                      00005 ;  MPASM PIC16F1703 processor include
                      00006 ; 
                      00007 ;  (c) Copyright 1999-2016 Microchip Technology, All rights reserved
                      00008 ;==========================================================================
                      00009 
                      01152         LIST
                      00038 
                      00039 ;;;;;;;;;;;;;;
                      00040 ; config  bits
                      00041 ;;;;;;;;;;;;;;
8007   39E4           00042     __config  _CONFIG1, _FOSC_INTOSC & _WDTE_OFF & _PWRTE_OFF & _MCLRE_ON & _CP_OFF & _BOREN_OFF & _CLKO
                            UTEN_OFF
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

8008   1E7F           00043     __config  _CONFIG2, _WRT_OFF & _PPS1WAY_ON & _ZCDDIS_OFF & _PLLEN_OFF & _STVREN_ON & _LPBOR_OFF & _L
                            VP_OFF  
                      00044     
                      00045 #define TONE_PIN RA1 ; sortie alarme    
                      00046 #define SERVO_PIN RA2 ; sortie contrôle servo moteur  
                      00047 #define TONE_LAT LATA
                      00048 #define SERVO_LAT LATA    
                      00049 #define TONE_TRIS TRISA
                      00050 #define SERVO_TRIS TRISA
                      00051 #define SERVO_WPU WPUA    
                      00052 #define TONE_WPU WPUA    
                      00053 #define TONE_PIN_PPS RA1PPS
                      00054 #define TONE_OUT_FN  H'C' ; PWM1
                      00055 #define TONE_CCPRL  CCPR1L
                      00056 #define TONE_CCPCON  CCP1CON    
                      00057 #define SERVO_PIN_PPS RA2PPS
                      00058 #define SERVO_OUT_FN H'D'   ; PWM2
                      00059 #define SERVO_CCPRL CCPR2L
                      00060 #define SERVO_CCPCON CCP2CON    
                      00061 #define START_PIN   RA5 ; bouton start sur RA5
                      00062 #define START_TRIS TRISA
                      00063 #define START_PORT PORTA    
                      00064 #define TIMESET_PIN RA4 ; bouton time set sur RA4
                      00065 #define TIMESET_TRIS TRISA    
                      00066 #define TIMESET_PORT PORTA    
                      00067 #define START_IOCN IOCAN ;registre détection transition négative
                      00068 #define START_IOCF IOCAF ;registre indication interruption
                      00069 #define BTN_TRIS TRISA 
                      00070 #define BTN_PORT PORTA    
                      00071 #define BTN_WPU  WPUA    
                      00072 #define DISPLAY PORTC ; port barre de LED
                      00073 #define DISP_TRIS TRISC
                      00074 #define DISP_LAT  LATC
                      00075 #define DISP_WPU  WPUC
                      00076     
                      00077 ; broches des anodes LED    
                      00078 #define A1      RC0
                      00079 #define A2      RC0
                      00080 #define A3      RC0    
                      00081 #define A4      RC1
                      00082 #define A5      RC1
                      00083 #define A6      RC1    
                      00084 #define A7      RC2
                      00085 #define A8      RC2
                      00086 #define A9      RC2    
                      00087 #define A10     RC3    
                      00088 ; broches des cathodes LED    
                      00089 #define C1      RC5
                      00090 #define C2      RC4
                      00091 #define C3      RC3
                      00092 #define C4      RC5
                      00093 #define C5      RC4
                      00094 #define C6      RC3
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00095 #define C7      RC5
                      00096 #define C8      RC4
                      00097 #define C9      RC3
                      00098 #define C10     RC2
                      00099 ;indicateurs booléens 
                      00100 #define F_SEC    0 ; minuterie seconde 1=active, 0=inactive
                      00101 #define F_MSEC4  1 ; minuterie msec4 1=active, 0=inactive    
                      00102 
                      00103 #define ALARM_TABLE  soldomi   
                      00104 
                      00105 #define TOS INDF1  ; top of stack
                      00106     
                      00107 ;#define DEBUG  
                      00108     
                      00109 ;;;;;;;;;;;;;;    
                      00110 ; constantes
                      00111 ;;;;;;;;;;;;;;
  000E                00112     constant F8MHZ=0xE ; valeur de OSCCON:IRCF pour 8Mhz
  000C                00113     constant F2MHZ=0xC ; valeur de OSSCCON:IRCF pour 2Mhz
  0EA6                00114     constant TIME_INCR = .15000/.4 ; incrément de 15 secondes
  927C                00115     constant TIME_MAX = TIME_INCR*.10 ; 150 secondes
  0006                00116     constant TMR0_DLY=.256-.250      ; compte pour TMR0
  8300                00117     constant TMR1_DLY=.65536-.32000  ; compte pour TMR1H:TMR1L
  009B                00118     constant SERVO_PERIOD=.155       ; compte pour PR2
  002F                00119     constant SERVO_NEUTRAL_PULSE=.47 ; compte pour CCP2RL:CCP2CON:DC2B
  002F                00120     constant SERVO_POS_BAS=.47       ; " 
  003C                00121     constant SERVO_POS_HAUT=.60      ; "
  0003                00122     constant SERVO_DLY=.3  ; contrôle vitesse de rotation
                      00123     
  0009                00124     constant NOMBRE_MELODIES=.9 ; nombre de mélodies pour la boite à musique
                      00125     
                      00126 ;;;;;;;;;;;;;;    
                      00127 ; macros    
                      00128 ;;;;;;;;;;;;;;
                      00129 ; macros pour la gestion de la pile des arguments
                      00130 pushw macro ; empile WREG  ( -- n )
                      00131     movwi ++FSR1
                      00132     endm
                      00133     
                      00134 popw macro ; dépile dans WREG ( n -- )
                      00135     moviw FSR1--
                      00136     endm
                      00137 drop macro ; jette le sommet de la pile
                      00138     addfsr FSR1,0x3f
                      00139     endm
                      00140     
                      00141 over macro ; copie 2ième élément de la pile  ( n2 n1 - n2 n1 n2)
                      00142     moviw (-1)&0x3f[FSR1]
                      00143     pushw
                      00144     endm
                      00145  
                      00146 dup macro ; copie TOS   ( n -- n n )
                      00147     moviw 0[FSR1]
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00148     movwi ++FSR1
                      00149     endm
                      00150 
                      00151 swap macro ; ( n1 n2 -- n2 n1 )
                      00152    popw
                      00153    xorwf INDF,F
                      00154    xorwf INDF,W
                      00155    xorwf INDF,F
                      00156    pushw
                      00157    endm
                      00158     
                      00159 ; toutes les pins du port DISP_PORT sont mises en mode entrée
                      00160 ; avec weak pullup actif
                      00161 display_disable macro
                      00162     movlw 0x3f
                      00163     banksel DISP_TRIS
                      00164     movwf DISP_TRIS
                      00165     banksel DISP_WPU
                      00166     movwf DISP_WPU
                      00167     endm
                      00168 
                      00169 ; désactivation des weak pullup pour ne pas interférer avec
                      00170 ; le charlieplexing.
                      00171 display_enable macro
                      00172     banksel DISP_WPU
                      00173     clrf DISP_WPU
                      00174     endm
                      00175 
                      00176 
                      00177 ; le canal PWM de l'alarme est désactivé.
                      00178 ; les broches TONE_PIN et ENV_PIN misent en mode entrée avec
                      00179 ; weak pullup
                      00180 alarm_disable macro
                      00181     banksel TONE_TRIS ; tous les TRISx sont dans la même banque
                      00182     bsf TONE_TRIS, TONE_PIN
                      00183     bsf ENV_TRIS, ENV_PIN
                      00184     banksel TONE_WPU  ; tous les WPUx sont dans la même banque
                      00185     bsf TONE_WPU, TONE_PIN
                      00186     bsf ENV_WPU, ENV_PIN
                      00187     banksel TONE_CON
                      00188     bcf TONE_CON, TONE_OE ; désactive sortie PWM
                      00189     endm
                      00190 
                      00191 case macro n, addr
                      00192     xorlw n
                      00193     skpnz
                      00194     bra addr
                      00195     xorlw n
                      00196     endm
                      00197     
                      00198 ;;;;;;;;;;;;;;
                      00199 ; variables
                      00200 ;;;;;;;;;;;;;;
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00201     udata
0000                  00202 stack res 16
                      00203  
                      00204     udata_shr
                      00205 ; 2 accumulateur 16 bits
0000                  00206 ACAL res 1   ; accumulateur A octet poids faible
0001                  00207 ACAH res 1  ; accumulateur A octet poids fort
0002                  00208 ACBL res 1  ; accumulateur B  octet poids faible
0003                  00209 ACBH res 1  ; accumulateur B  octet poids fort
0004                  00210 trempage res 1 ; durée du trempage en secondes 
0005                  00211 secondes res 1 ; compte à rebours secondes, interruption TIMER1
0006                  00212 msec4 res 1 ; compte à rebours décrément 4 msec, interruption TIMER0
0007                  00213 pwm_period res 1 ; période pour contrôler l'intensité du segment LED 
0008                  00214 flags res 1; indicateurs booléens.
0009                  00215 temp res 1 ; variable temporaire 
000A                  00216 last_pos res 1 ; dernière commande envoyée au servo-moteur 
000B                  00217 rseed res 3  ; graine générateur pseudo-hasard
000E                  00218 musique res 1 ; indique quelle mélodie jouer
                      00219  
                      00220 ;;;;;;;;;;;;;;
                      00221 ; code
                      00222 ;;;;;;;;;;;;;;
                      00223     code 
                      00224     org 0
                      00225 ; vecteur reset    
0000                  00226 rst:
0000   2???           00227     goto init
0001   0000           00228     nop
0002   0000           00229     nop
0003   0000           00230     nop
                      00231 ; service des interruptions    
                      00232     org 4
0004                  00233 isr:
0004   1E8B           00234     btfss INTCON, T0IE
0005   3???           00235     bra test_tmr1
0006   190B           00236     btfsc INTCON, T0IF
0007   3???           00237     bra isr_timer0
0008                  00238 test_tmr1:
0008   1F0B           00239     btfss INTCON, PEIE
0009   3???           00240     bra isr_exit ; interruption non traitée.
000A   0020           00241     banksel PIR1
000B   1C11           00242     btfss PIR1, TMR1IF
000C   3???           00243     bra isr_exit ; interuption non traité
000D                  00244 isr_timer1: ; répond à l'interuption sur TIMER1, intervalle 1 secondes
000D   1011           00245     bcf PIR1, TMR1IF
000E   0020           00246     banksel TMR1L
000F   3000           00247     movlw low TMR1_DLY
0010   0096           00248     movwf TMR1L
0011   3083           00249     movlw high TMR1_DLY
0012   0097           00250     movwf TMR1H
0013   0B??           00251     decfsz secondes,F
0014   3???           00252     bra isr_exit
                      00253 ; minuterie expiré désactive interuption
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015   1000           00254     bcf flags, F_SEC
0016   0021           00255     banksel PIE1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0017   1011           00256     bcf PIE1,TMR1IE
0018   130B           00257     bcf INTCON, PEIE
0019   1E8B           00258     btfss INTCON, T0IE ; déscative toutes interruption
001A   0020           00259     banksel T1CON
001B   1018           00260     bcf T1CON, TMR1ON  ; arrête TIMER1
001C   138B           00261     bcf INTCON, GIE    ; si TIMER0 n'est pas en cours d'utilisation
001D   3???           00262     bra isr_exit
001E                  00263 isr_timer0: ; répond à l'innterruption sur TIMER0, intervalle 4 msec.   
001E   0020           00264     banksel TMR0
001F   3006           00265     movlw TMR0_DLY
0020   0095           00266     movwf TMR0
0021   110B           00267     bcf INTCON,T0IF
0022   0B??           00268     decfsz msec4,F
0023   3???           00269     bra isr_exit
0024                  00270 disable_timer:    
0024   1080           00271     bcf flags, F_MSEC4
0025   128B           00272     bcf INTCON,T0IE
0026   1F0B           00273     btfss INTCON, PEIE
0027   138B           00274     bcf INTCON, GIE   ;si TIMER1 n'est pas utilisé présentiment
0028                  00275 isr_exit:    
0028   0009           00276     retfie
                      00277     
0029                  00278 init:
                      00279 ; fréquence clock à 8Mhz
0029   0021           00280     banksel OSCCON
002A   3070           00281     movlw F8MHZ<<IRCF0  ; Fosc 8Mhz
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
002B   0099           00282     movwf OSCCON
                      00283 ; initialisation pointeur de la pile des arguments
002C   30??           00284     movlw high stack
002D   0087           00285     movwf FSR1H
002E   30??           00286     movlw low stack
002F   0086           00287     movwf FSR1L
                      00288 ; assignation des périphériques au broches
                      00289 ; PWM1 sur TONE_PIN   
0030   003D           00290     banksel TONE_PIN_PPS
0031   300C           00291     movlw TONE_OUT_FN  ; fonction PWM1 
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0032   0091           00292     movwf TONE_PIN_PPS   
                      00293 ; PWM2 sur SERVO_PIN
0033   003D           00294     banksel SERVO_PIN_PPS
0034   300D           00295     movlw SERVO_OUT_FN  ; fonction PWM2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0035   0092           00296     movwf SERVO_PIN_PPS
                      00297 ; veroullage PPS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0036   140F           00298     bsf PPSLOCK, 0
                      00299 ; activation low power sleep mode
0037   0023           00300     banksel VREGCON
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0038   1497           00301     bsf VREGCON, VREGPM
                      00302 ; enlever weak pullup sur broche sortie TONE
0039   0024           00303     banksel TONE_WPU
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003A   108C           00304     bcf TONE_WPU,TONE_PIN
                      00305 ; entrée analogique non utilisée
003B   0023           00306     banksel ANSELA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003C   018C           00307     clrf ANSELA
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
003D   018E           00308     clrf ANSELC
                      00309 ;    display_disable
                      00310 ; configuration OPTION_REG TIMER0 prescale 64
003E   0021           00311     banksel OPTION_REG
003F   3004           00312     movlw 4 ; TIMER0 préscale 1:32
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0040   0095           00313     movwf OPTION_REG
                      00314 ; met SERVO_PIN en sortie bas voltage
0041   0021           00315     banksel SERVO_TRIS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0042   110C           00316     bcf SERVO_TRIS, SERVO_PIN
0043   0022           00317     banksel SERVO_LAT
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0044   110C           00318     bcf SERVO_LAT, SERVO_PIN
                      00319 ; configuration de la sortie pour son
0045   0021           00320     banksel TONE_TRIS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0046   108C           00321     bcf TONE_TRIS, TONE_PIN ; broche en mode sortie
                      00322 ;variables à zéro
0047   01??           00323     clrf flags 
0048   01??           00324     clrf secondes
0049   01??           00325     clrf msec4
004A   01??           00326     clrf musique
                      00327 ; initialise rseed    
004B   3003           00328     movlw 3
004C   00??           00329     movwf rseed
Message[305]: Using default destination of 1 (file).
004D   3589           00330     lslf WREG
004E   00??           00331     movwf rseed+1
Message[305]: Using default destination of 1 (file).
004F   3589           00332     lslf WREG
0050   00??           00333     movwf rseed+2
                      00334     
0051   303C           00335     movlw SERVO_POS_HAUT
0052   00??           00336     movwf last_pos
0053   2???           00337     call self_test
0054                  00338 main:
0054   2???           00339     call rand
                      00340 ; activation interruption sur bouton START enfoncé
                      00341 ; ceci pour permettre la sortie du mode SLEEP en enfoncant ce bouton    
0055   0027           00342     banksel START_IOCF
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0056   1293           00343     bcf START_IOCF, START_PIN ; remise à zéro indicateur interruption
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0057   0027           00344     banksel START_IOCN
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0058   1692           00345     bsf START_IOCN, START_PIN ;déclenchement interruption sur transition négative
0059   158B           00346     bsf INTCON, IOCIE  ; activation interruption sur transition broche.
005A   0063           00347     sleep
                      00348 ;désactivation IOCN
005B   118B           00349     bcf INTCON, IOCIE
005C   0027           00350     banksel START_IOCN
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
005D   1292           00351     bcf START_IOCN,START_PIN
005E   0020           00352     banksel TIMESET_PORT
005F   1A0C           00353     btfsc TIMESET_PORT,TIMESET_PIN
0060   3???           00354     bra eveil_normal
                      00355 ;fonction cachée
0061   2???           00356     call boite_a_musique
0062   3???           00357     bra main
0063                  00358 eveil_normal:  
0063   300F           00359     movlw .15
0064   00??           00360     movwf secondes
                      00361 ; tonalité d'éveil
0065   3014           00362     movlw .20
                      00363     pushw
0066   001C               M     movwi ++FSR1
0067   3001           00364     movlw 1
                      00365     pushw
0068   001C               M     movwi ++FSR1
0069   2???           00366     call tone
                      00367 ; ajustement du temps
006A   2???           00368     call timeset
                      00369 ; descente du sachet dans la tasse
006B   302F           00370     movlw SERVO_POS_BAS 
006C   2???           00371     call servo_pos
                      00372 ;   attend expiration de la minuterie
                      00373 ;   avec mise à jour de LED_BAR    
006D   2???           00374     call infusion
                      00375 ;   minuterie  expirée soulève le sachet    
006E   303C           00376     movlw SERVO_POS_HAUT
006F   2???           00377     call servo_pos
                      00378 ;   sonne l'alarme
0070   2???           00379     call alarm
                      00380 ; lorsque la séquence est terminée retourne en sommeil
0071   3???           00381     bra main
                      00382     
                      00383     
                      00384 ;l'utilisateur doit ajuster le temps de trempage    
0072                  00385 timeset:
0072   08??           00386     movfw secondes
0073   00??           00387     movwf trempage
0074   0020           00388     banksel BTN_PORT
                      00389 ; attend qu'un bouton soit enfoncé.
0075                  00390 timeset_wait_btn:   
                      00391     display_enable
0075   0024               M     banksel DISP_WPU
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0076   018E               M     clrf DISP_WPU
0077   08??           00392     movfw trempage
0078   2???           00393     call div15
0079   2???           00394     call light_segment
007A   3064           00395     movlw .100
007B   2???           00396     call pause_msec
007C   080C           00397     movfw BTN_PORT
007D   3930           00398     andlw (1<<START_PIN)|(1<<TIMESET_PIN)
007E   3A30           00399     xorlw (1<<START_PIN)|(1<<TIMESET_PIN)
007F   1903           00400     skpnz
0080   3???           00401     bra $-4
0081   1A09           00402     btfsc WREG,TIMESET_PIN
0082   3???           00403     bra add_time
0083   1A89           00404     btfsc WREG, START_PIN
0084   3???           00405     bra timeset_exit
0085   3???           00406     bra timeset_wait_btn
0086                  00407 add_time:
0086   300F           00408     movlw .15
Message[305]: Using default destination of 1 (file).
0087   07??           00409     addwf trempage
0088   3097           00410     movlw .151
0089   02??           00411     subwf trempage,W
008A   1803           00412     skpnc
008B   01??           00413     clrf trempage
008C   2???           00414     call beep
008D   3???           00415     bra timeset_wait_btn
008E                  00416 timeset_exit:
                      00417     display_disable
008E   303F               M     movlw 0x3f
008F   0021               M     banksel DISP_TRIS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0090   008E               M     movwf DISP_TRIS
0091   0024               M     banksel DISP_WPU
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0092   008E               M     movwf DISP_WPU
0093   2???           00418     call beep
                      00419 ; attend relâchement du bouton    
0094   0020           00420     banksel BTN_PORT
0095   1E8C           00421     btfss BTN_PORT, START_PIN
0096   3???           00422     bra $-1
0097   0008           00423     return
                      00424 
                      00425 ; son court    
0098                  00426 beep:
0098   300A           00427     movlw .10
                      00428     pushw
0099   001C               M     movwi ++FSR1
009A   0103           00429     clrw
                      00430     pushw
009B   001C               M     movwi ++FSR1
009C   2???           00431     call tone
009D   0008           00432     return
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00433     
                      00434 ;  attend expiration de la minuterie
                      00435 ;  mise à jour affichage
                      00436 #define RESTE ACAL    
009E                  00437 infusion:
009E   08??           00438     movfw trempage
009F   1903           00439     skpnz
00A0   3???           00440     bra timeout
00A1   2???           00441     call start_timer
                      00442     display_enable
00A2   0024               M     banksel DISP_WPU
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00A3   018E               M     clrf DISP_WPU
00A4                  00443 wait_loop:
00A4   0020           00444     banksel BTN_PORT
00A5   1E8C           00445     btfss BTN_PORT, START_PIN ; cancellation si bouton enfoncé
00A6   3???           00446     bra cancellation
00A7   1C00           00447     btfss flags, F_SEC
00A8   3???           00448     bra timeout
00A9   08??           00449     movfw secondes
00AA   2???           00450     call div15
00AB   00??           00451     movwf temp
00AC   08??           00452     movf RESTE,F
00AD   1903           00453     skpnz
00AE   3???           00454     bra $+3
Message[305]: Using default destination of 1 (file).
00AF   0A??           00455     incf temp
00B0   3???           00456     bra $+3
00B1   300F           00457     movlw 0xf
00B2   00??           00458     movwf RESTE
                      00459 ; initialise période pour PWM intensité LED
00B3   300F           00460     movlw 0xf
00B4   00??           00461     movwf pwm_period
00B5                  00462 pwm_loop:
00B5   08??           00463     movf RESTE,F
00B6   1903           00464     skpnz
00B7   01??           00465     clrf temp
00B8   08??           00466     movfw temp
00B9   2???           00467     call light_segment
00BA   08??           00468     movf RESTE,F
00BB   1D03           00469     skpz
00BC   03??           00470     decf RESTE,F
Message[305]: Using default destination of 1 (file).
00BD   03??           00471     decf pwm_period
00BE   1D03           00472     skpz
00BF   3???           00473     bra pwm_loop
00C0   3???           00474     bra wait_loop
00C1                  00475 cancellation:
00C1   1000           00476     bcf flags, F_SEC
00C2   128B           00477     bcf INTCON, T0IE
00C3   01??           00478     clrf secondes
00C4                  00479 timeout:    
                      00480     display_disable
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00C4   303F               M     movlw 0x3f
00C5   0021               M     banksel DISP_TRIS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C6   008E               M     movwf DISP_TRIS
00C7   0024               M     banksel DISP_WPU
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00C8   008E               M     movwf DISP_WPU
00C9   0008           00481     return
                      00482 
                      00483 
                      00484 ; sonne l'alarme de fin de trempage    
00CA                  00485 alarm:
                      00486 ; initialition pointeur table CE3K
00CA   30??           00487     movlw high ALARM_TABLE
00CB   0085           00488     movwf FSR0H
                      00489 ;    bsf FSR0H,7
00CC   30??           00490     movlw low ALARM_TABLE
00CD   0084           00491     movwf FSR0L
00CE   0012           00492     moviw FSR0++
                      00493     pushw ;nombre de notes à jouer
00CF   001C               M     movwi ++FSR1
                      00494 ;sauvegarde du pointeur
00D0   0804           00495     movfw FSR0L
00D1   00??           00496     movwf ACAL
00D2   0805           00497     movfw FSR0H
00D3   00??           00498     movwf ACAH
00D4                  00499 alarm_loop:
                      00500 ;restauration du pointeur    
00D4   08??           00501     movfw ACAL
00D5   0084           00502     movwf FSR0L
00D6   08??           00503     movfw ACAH
00D7   0085           00504     movwf FSR0H
00D8   0012           00505     moviw FSR0++
                      00506     pushw  ; durée note
00D9   001C               M     movwi ++FSR1
00DA   0012           00507     moviw FSR0++
                      00508     pushw  ; indice note
00DB   001C               M     movwi ++FSR1
                      00509 ;sauvegarde du pointeur    
00DC   0804           00510     movfw FSR0L
00DD   00??           00511     movwf ACAL
00DE   0805           00512     movfw FSR0H
00DF   00??           00513     movwf ACAH
00E0   2???           00514     call tone
Message[305]: Using default destination of 1 (file).
00E1   0B81           00515     decfsz TOS
00E2   3???           00516     bra alarm_loop
                      00517     popw
00E3   0017               M     moviw FSR1--
00E4   0008           00518     return
                      00519 
                      00520 ; fait entendre une tonalité
                      00521 ; entrée:  pile ( d n -- )
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00522 ;    d -> durée en multiple de 4 msec.
                      00523 ;    n -> indice de la note dans la table SCALE    
00E5                  00524 tone:
                      00525 ; prépare FSR0 pour accéder table SCALE
00E5   30??           00526     movlw high SCALE
00E6   0085           00527     movwf FSR0H
                      00528 ;    bsf FSR0H,7
00E7   30??           00529     movlw low SCALE
00E8   0084           00530     movwf FSR0L
                      00531 ;ajoute l'indice de la note à FSR0    
                      00532     popw
00E9   0017               M     moviw FSR1--
Message[305]: Using default destination of 1 (file).
00EA   0784           00533     addwf FSR0L
00EB   3000           00534     movlw 0
Message[305]: Using default destination of 1 (file).
00EC   1803 0A85      00535     addcf FSR0H
00EE   0800           00536     movfw INDF0
00EF   0020           00537     banksel PR2
00F0   009B           00538     movwf PR2  ;la valeur retirée de SCALE détermine la période PWM
00F1   0025           00539     banksel TONE_CCPCON
00F2   303C           00540     movlw (0xC<<CCP1M0)|(3<<DC1B0)
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F3   0093           00541     movwf TONE_CCPCON
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
00F4   0191           00542     clrf TONE_CCPRL   ; les 6 bits les plus significatifs du rapport cyclique
                      00543 ; activation minuterie TIMER2
00F5   0020           00544     banksel T2CON
00F6   3006           00545     movlw (2<<T2CKPS0)|(1<<TMR2ON)
00F7   009C           00546     movwf T2CON ; préscale 16 et TIMER2 on.
                      00547     popw ; durée note
00F8   0017               M     moviw FSR1--
00F9   2???           00548     call start_msec4_tmr
00FA   0020           00549     banksel PR2
00FB   361B           00550     lsrf PR2,W
Message[305]: Using default destination of 1 (file).
00FC   3689           00551     lsrf WREG
Message[305]: Using default destination of 1 (file).
00FD   3689           00552     lsrf WREG ; rapport cyclique maximal PR2/8
                      00553     pushw
00FE   001C               M     movwi ++FSR1
00FF                  00554 attack:    
00FF   0020           00555     banksel PIR1
0100   1091           00556     bcf PIR1,TMR2IF
0101   1C91           00557     btfss PIR1,TMR2IF
0102   3???           00558     bra $-1
0103   0025           00559     banksel TONE_CCPRL
0104   3004           00560     movlw 4
Message[305]: Using default destination of 1 (file).
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0105   0791           00561     addwf TONE_CCPRL
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0106   0811           00562     movfw TONE_CCPRL
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0107   0201           00563     subwf TOS,W
0108   1803           00564     skpnc
0109   3???           00565     bra attack
010A                  00566 sustain:
                      00567     popw
010A   0017               M     moviw FSR1--
010B   1880           00568     btfsc flags, F_MSEC4
010C   3???           00569     bra $-1
010D                  00570 decay: ; décroissance rapport cyclique
010D   0025           00571     banksel TONE_CCPRL
010E   3002           00572     movlw 2
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
010F   0291           00573     subwf TONE_CCPRL,F
0110   1C03           00574     skpc
0111   3???           00575     bra tone_end
0112   0020           00576     banksel PIR1
0113   1091           00577     bcf PIR1, TMR2IF
0114   1C91           00578     btfss PIR1,TMR2IF
0115   3???           00579     bra $-1 ; attent fin cycle PWM
0116   3???           00580     bra decay
0117                  00581 tone_end:    
                      00582 ;arrête TIMER2
0117   0020           00583     banksel T2CON
0118   111C           00584     bcf T2CON, TMR2ON
0119   0025           00585     banksel TONE_CCPCON
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
011A   0193           00586     clrf TONE_CCPCON
011B   0022           00587     banksel TONE_LAT
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
011C   108C           00588     bcf TONE_LAT, TONE_PIN
011D   0008           00589     return
                      00590     
                      00591 ; allume un segment de la barre LED
                      00592 ; entrée:
                      00593 ;   W contient le numéro du segment
                      00594 ;   à allumer
011E                  00595 light_segment:
                      00596     pushw
011E   001C               M     movwi ++FSR1
                      00597 ; initialise FSR0 pour pointer sur la table LED_CON
011F   30??           00598     movlw high LED_CONN
0120   0085           00599     movwf FSR0H
                      00600 ;    bsf FSR0H, 7
0121   30??           00601     movlw low LED_CONN
0122   0084           00602     movwf FSR0L
                      00603     popw
0123   0017               M     moviw FSR1--
Message[305]: Using default destination of 1 (file).
0124   3589           00604     lslf WREG   ; segment * 2
Message[305]: Using default destination of 1 (file).
0125   0784           00605     addwf FSR0L ; ajuste le pointeur de table
0126   3000           00606     movlw 0
Message[305]: Using default destination of 1 (file).
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0127   1803 0A85      00607     addcf FSR0H 
0129   0800           00608     movfw INDF0  ; obtient valeur sortie PORT
012A   0022           00609     banksel DISP_LAT
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
012B   008E           00610     movwf DISP_LAT
Message[305]: Using default destination of 1 (file).
012C   0A84           00611     incf FSR0L
012D   0800           00612     movfw INDF0  ; obtient valeur TRIS
012E   0021           00613     banksel DISP_TRIS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
012F   008E           00614     movwf DISP_TRIS
0130   0008           00615     return
                      00616 
                      00617 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
                      00618 ; commande la position du servo-moteur
                      00619 ; NOTE:
                      00620     ; la fréquence de l'oscillateur est descendue à 2Mhz pour
                      00621     ; permettre une période de 20msec avec T2
                      00622     ; le préscale de T2 est programmé à 1/64
                      00623     ; la période T=(PR2+1)*4*Tosc*PS=156*4*5e-7*64=0,019968
                      00624     ; la résolution est de Tosc*64=5e-7*64/4=32µSec
                      00625 ;  entrée:
                      00626 ;      W contient la valeur de contrôle
                      00627 ;  valeur comprise entre SERVO_POS_BAS et SERVO_POS_HAUT
                      00628 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;    
0131                  00629 servo_pos:
                      00630     pushw
0131   001C               M     movwi ++FSR1
                      00631 ; contrôle des limites    
0132   302F           00632     movlw SERVO_POS_BAS
0133   0201           00633     subwf TOS,W
0134   302F           00634     movlw SERVO_POS_BAS
0135   1C03           00635     skpc
0136   0081           00636     movwf TOS
0137   303C           00637     movlw SERVO_POS_HAUT
0138   0201           00638     subwf TOS,W
0139   303C           00639     movlw SERVO_POS_HAUT
013A   1803           00640     skpnc
013B   0081           00641     movwf TOS
                      00642 ; pour obtenir une période de 50 Hertz sur TIMER2 il faut réduire
                      00643 ; Fosc à 2Mhz
013C   0021           00644     banksel OSCCON
013D   3060           00645     movlw F2MHZ<<IRCF0   ; Fosc=2Mhz
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
013E   0099           00646     movwf OSCCON
                      00647 ; configuration TIMER2 pour période 20 msec
013F   0020           00648     banksel T2CON
0140   309B           00649     movlw SERVO_PERIOD ; 20msec
0141   009B           00650     movwf PR2
0142   3007           00651     movlw (3<<T2CKPS0)|(1<<TMR2ON)
0143   009C           00652     movwf T2CON
                      00653 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;    
                      00654 ; pour contrôler la vitesse de rotation
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00655 ; on part de valeur de l'ancienne commande
                      00656 ; en progressant vers la nouvelle valeur    
                      00657 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;    
                      00658 ;durée du pulse 8 bits les plus significatifs dans CCP2RL et les 
                      00659 ;2 moins significatifs dans CCP2CON:4,5
0144                  00660 servo_pos_loop:
0144   0025           00661     banksel SERVO_CCPCON
0145   36??           00662     lsrf last_pos,W
Message[305]: Using default destination of 1 (file).
0146   3689           00663     lsrf WREG
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0147   0098           00664     movwf SERVO_CCPRL
0148   0E??           00665     swapf last_pos,W
0149   3930           00666     andlw (3<<4)
014A   380C           00667     iorlw 3<<CCP2M2  ; mode PWM
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
014B   009A           00668     movwf SERVO_CCPCON
                      00669 ; attend la fin du cycle
014C   3003           00670     movlw SERVO_DLY
014D   00??           00671     movwf ACAL
014E                  00672 delay:
014E   0020           00673     banksel PIR1
014F   1091           00674     bcf PIR1,TMR2IF
0150   1C91           00675     btfss PIR1,TMR2IF
0151   3???           00676     bra $-1
0152   0B??           00677     decfsz ACAL,F
0153   3???           00678     bra delay
0154   0801           00679     movfw TOS
0155   02??           00680     subwf last_pos,W
0156   1903           00681     skpnz
0157   3???           00682     bra servo_pos_exit
0158   0801           00683     movfw TOS
0159   02??           00684     subwf last_pos,W
015A   1C03           00685     skpc
015B   0A??           00686     incf last_pos,F
015C   1803           00687     skpnc
015D   03??           00688     decf last_pos,F
015E   3???           00689     bra servo_pos_loop
015F                  00690 servo_pos_exit:  
                      00691     popw
015F   0017               M     moviw FSR1--
                      00692 ;arret de la commande
                      00693 ;attend la fin du cycle PWM
0160   0020           00694     banksel PR2
0161   081B           00695     movfw PR2
0162   021A           00696     subwf TMR2,W
0163   1C03           00697     skpc
0164   3???           00698     bra $-3
0165   0025           00699     banksel SERVO_CCPCON
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
0166   019A           00700     clrf SERVO_CCPCON
0167   0020           00701     banksel T2CON
0168   111C           00702     bcf T2CON, TMR2ON
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00703 ;remet Fosc à 8Mhz    
0169   0021           00704     banksel OSCCON
016A   3070           00705     movlw F8MHZ<<IRCF0  ; Fosc=8Mhz
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
016B   0099           00706     movwf OSCCON
016C   0008           00707     return
                      00708     
                      00709 ; division non signée entier 8 bits par 15
                      00710 ; entrée:
                      00711 ;   dividende dans W
                      00712 ;sortie:
                      00713 ;   quotient dans ACAH
                      00714 ;   reste dans ACAL    
                      00715 #define DIVIDENDE ACAL    
                      00716 #define QUOTIENT ACAH
                      00717 #define DIVISEUR ACBL    
016D                  00718 div15:
016D   01??           00719     clrf QUOTIENT
016E   3A00           00720     xorlw 0
016F   1903           00721     skpnz
0170   3???           00722     bra div15_exit
0171   00??           00723     movwf DIVIDENDE
0172   30F0           00724     movlw 0xF0 ; diviseur<<4
0173   00??           00725     movwf DIVISEUR
0174   02??           00726     subwf DIVIDENDE,W
0175   1C03           00727     skpc
0176   3???           00728     bra div15_1
0177   1600           00729     bsf QUOTIENT,4
0178   00??           00730     movwf DIVIDENDE ; conserve reste pour prochaine étape
0179                  00731 div15_1:
Message[305]: Using default destination of 1 (file).
0179   36??           00732     lsrf DIVISEUR
017A   08??           00733     movfw DIVISEUR
017B   02??           00734     subwf DIVIDENDE,W
017C   1C03           00735     skpc
017D   3???           00736     bra div15_2
017E   1580           00737     bsf QUOTIENT,3
017F   00??           00738     movwf DIVIDENDE
0180                  00739 div15_2:
Message[305]: Using default destination of 1 (file).
0180   36??           00740     lsrf DIVISEUR
0181   08??           00741     movfw DIVISEUR
0182   02??           00742     subwf DIVIDENDE,W
0183   1C03           00743     skpc
0184   3???           00744     bra div15_3
0185   1500           00745     bsf QUOTIENT,2
0186   00??           00746     movwf DIVIDENDE
0187                  00747 div15_3:
Message[305]: Using default destination of 1 (file).
0187   36??           00748     lsrf DIVISEUR
0188   08??           00749     movfw DIVISEUR
0189   02??           00750     subwf DIVIDENDE,W
018A   1C03           00751     skpc
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

018B   3???           00752     bra div15_4
018C   1480           00753     bsf QUOTIENT,1
018D   00??           00754     movwf DIVIDENDE
018E                  00755 div15_4:
Message[305]: Using default destination of 1 (file).
018E   36??           00756     lsrf DIVISEUR
018F   08??           00757     movfw DIVISEUR
0190   02??           00758     subwf DIVIDENDE,W
0191   1803           00759     skpnc
0192   1400           00760     bsf QUOTIENT,0
0193                  00761 div15_exit:
0193   08??           00762     movfw QUOTIENT
0194   0008           00763     return
                      00764 
                      00765 ; démarre la minuterie des secondes
                      00766 ; utilisation du TIMER1 avec LFOSC.    
                      00767 ; entrée:
                      00768 ;   W=durée en secondes    
0195                  00769 start_timer:
0195   00??           00770     movwf secondes
0196   0020           00771     banksel TMR1H
0197   3083           00772     movlw high TMR1_DLY
0198   0097           00773     movwf TMR1H
0199   3000           00774     movlw low TMR1_DLY
019A   0096           00775     movwf TMR1L
019B   30C1           00776     movlw (3<<TMR1CS0)|1
019C   0098           00777     movwf T1CON
019D   0020           00778     banksel PIR1
019E   1011           00779     bcf PIR1, TMR1IF
019F   0021           00780     banksel PIE1
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01A0   1411           00781     bsf PIE1, TMR1IE
01A1   170B           00782     bsf INTCON,PEIE
01A2   178B           00783     bsf INTCON,GIE
01A3   1400           00784     bsf flags, F_SEC
01A4   0008           00785     return
                      00786 
                      00787     
                      00788 ; démarre la minuterie des millisecondes
                      00789 ; entrée:
                      00790 ;    W contient la durée en multiple de 4 msec.
01A5                  00791 start_msec4_tmr:
01A5   00??           00792     movwf msec4
01A6   0020           00793     banksel TMR0
01A7   3006           00794     movlw TMR0_DLY
01A8   0095           00795     movwf TMR0
01A9   110B           00796     bcf INTCON, T0IF
01AA   168B           00797     bsf INTCON, T0IE
01AB   178B           00798     bsf INTCON, GIE
01AC   1480           00799     bsf flags, F_MSEC4
01AD   0008           00800     return
                      00801 
                      00802 ;pause en multiple de 4 msec
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00803 ; entrée:  W -> pause= 4*W msec   
01AE                  00804 pause_msec:
01AE   2???           00805     call start_msec4_tmr
01AF   1880           00806     btfsc flags, F_MSEC4
01B0   3???           00807     bra $-1
01B1   0008           00808     return
                      00809 
                      00810 ;générateur pseudo-hasard
                      00811 ;modifie variable rseed
                      00812 ; fonction itérative
                      00813 ;   1) si rseed est impaire, incrémente rseed
                      00814 ;   2) multiplie rseed par 3/2
                      00815 ;   3) recommence à 1    
                      00816     radix dec
01B2                  00817 rand:
01B2   1C80           00818     btfss rseed,1 
01B3   3???           00819     bra no_incr
01B4   3001           00820     movlw 1         
01B5   07??           00821     addwf rseed, F
01B6   0189           00822     clrf WREG
01B7   1803 0A??      00823     addcf rseed+1,F
01B9   1803 0A??      00824     addcf rseed+2,F
01BB                  00825 no_incr:    
                      00826 ; empile rseed*2    
01BB   35??           00827     lslf rseed,W
                      00828     pushw 
01BC   001C               M     movwi ++FSR1
01BD   0D??           00829     rlf rseed+1,W
                      00830     pushw
01BE   001C               M     movwi ++FSR1
01BF   0D??           00831     rlf rseed+2,W
                      00832     pushw
01C0   001C               M     movwi ++FSR1
                      00833 ; additionne rseed*2 à rseed    
01C1   3F7E           00834     moviw -2[FSR1]
01C2   07??           00835     addwf rseed,F
01C3   3F7F           00836     moviw -1[FSR1]
01C4   1803 0A??      00837     addcf rseed+1,F
                      00838     popw
01C6   0017               M     moviw FSR1--
01C7   1803 0A??      00839     addcf rseed+2, F
                      00840 ; divise rseed par 2    
01C9   36??           00841     lsrf rseed+2,F
01CA   0C??           00842     rrf rseed+1,F
01CB   0C??           00843     rrf rseed, F
                      00844 ; jette rseed*2 qui est sur la pile    
                      00845     drop
01CC   317F               M     addfsr FSR1,0x3f
                      00846     drop
01CD   317F               M     addfsr FSR1,0x3f
01CE   0008           00847     return
                      00848     radix hex
                      00849     
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00850 ;auto test à l'allumage
                      00851 ; allume tous les segments l'un après l'autre
                      00852 ; test alarme
                      00853 ; test servo-moteur
01CF                  00854 self_test:
                      00855     display_enable
01CF   0024               M     banksel DISP_WPU
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01D0   018E               M     clrf DISP_WPU
01D1   300A           00856     movlw .10
                      00857     pushw
01D2   001C               M     movwi ++FSR1
01D3                  00858 disp_test:
01D3   0801           00859     movfw TOS
01D4   2???           00860     call light_segment
01D5   3019           00861     movlw .25
                      00862     pushw
01D6   001C               M     movwi ++FSR1
                      00863     over
01D7   3F7F               M     moviw (-1)&0x3f[FSR1]
                          M     pushw
01D8   001C               M     movwi ++FSR1
01D9   2???           00864     call tone
01DA   0B81           00865     decfsz TOS,F
01DB   3???           00866     bra disp_test
                      00867     popw
01DC   0017               M     moviw FSR1--
                      00868     display_disable
01DD   303F               M     movlw 0x3f
01DE   0021               M     banksel DISP_TRIS
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01DF   008E               M     movwf DISP_TRIS
01E0   0024               M     banksel DISP_WPU
Message[302]: Register in operand not in bank 0.  Ensure that bank bits are correct.
01E1   008E               M     movwf DISP_WPU
01E2                  00869 tone_test:
01E2   3014           00870     movlw .20
                      00871     pushw
01E3   001C               M     movwi ++FSR1
01E4   3015           00872     movlw .21
                      00873     pushw
01E5   001C               M     movwi ++FSR1
01E6   2???           00874     call tone
01E7                  00875 servo_test:
01E7   302F           00876     movlw SERVO_POS_BAS
01E8   2???           00877     call servo_pos
01E9   303C           00878     movlw SERVO_POS_HAUT
01EA   2???           00879     call servo_pos
01EB   0008           00880     return
                      00881 
                      00882 ; easter egg 
                      00883 ; fonction cachée obtenue lorsque le bouton
                      00884 ; temps est enfoncé lorsque l'utilisateur presse 
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00885 ; le bouton start
01EC                  00886 boite_a_musique:
01EC   3009           00887     movlw NOMBRE_MELODIES
01ED   02??           00888     subwf musique,W
01EE   1803           00889     skpnc
01EF   01??           00890     clrf musique
01F0   08??           00891     movfw musique
                      00892     case 0, musique_0
01F1   3A00               M     xorlw 0
01F2   1903               M     skpnz
01F3   3???               M     bra musique_0
01F4   3A00               M     xorlw 0
                      00893     case 1, musique_1
01F5   3A01               M     xorlw 1
01F6   1903               M     skpnz
01F7   3???               M     bra musique_1
01F8   3A01               M     xorlw 1
                      00894     case 2, musique_2
01F9   3A02               M     xorlw 2
01FA   1903               M     skpnz
01FB   3???               M     bra musique_2
01FC   3A02               M     xorlw 2
                      00895     case 3, musique_3
01FD   3A03               M     xorlw 3
01FE   1903               M     skpnz
01FF   3???               M     bra musique_3
0200   3A03               M     xorlw 3
                      00896     case 4, musique_4
0201   3A04               M     xorlw 4
0202   1903               M     skpnz
0203   3???               M     bra musique_4
0204   3A04               M     xorlw 4
                      00897     case 5, musique_5
0205   3A05               M     xorlw 5
0206   1903               M     skpnz
0207   3???               M     bra musique_5
0208   3A05               M     xorlw 5
                      00898     case 6, musique_6
0209   3A06               M     xorlw 6
020A   1903               M     skpnz
020B   3???               M     bra musique_6
020C   3A06               M     xorlw 6
                      00899     case 7, musique_7
020D   3A07               M     xorlw 7
020E   1903               M     skpnz
020F   3???               M     bra musique_7
0210   3A07               M     xorlw 7
0211                  00900 musique_8:
0211   30??           00901     movlw high KORO
0212   0085           00902     movwf FSR0H
0213   30??           00903     movlw low KORO
0214   0084           00904     movwf FSR0L
0215   3???           00905     bra joue
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0216                  00906 musique_7:    
                      00907 ; rencontre du 3ième type    
0216   30??           00908     movlw high ce3k
0217   0085           00909     movwf FSR0H
0218   30??           00910     movlw low ce3k
0219   0084           00911     movwf FSR0L
021A   3???           00912     bra joue
021B                  00913 musique_6:
021B   30??           00914     movlw high greensleeves
021C   0085           00915     movwf FSR0H
021D   30??           00916     movlw low greensleeves
021E   0084           00917     movwf FSR0L
021F   3???           00918     bra joue
0220                  00919 musique_5:
0220   30??           00920     movlw high gstq
0221   0085           00921     movwf FSR0H
0222   30??           00922     movlw low gstq
0223   0084           00923     movwf FSR0L
0224   3???           00924     bra joue
0225                  00925 musique_4:
0225   30??           00926     movlw high bon_tabac
0226   0085           00927     movwf FSR0H
0227   30??           00928     movlw low bon_tabac
0228   0084           00929     movwf FSR0L
0229   3???           00930     bra joue
022A                  00931 musique_3:
022A   30??           00932     movlw high frere_jacques
022B   0085           00933     movwf FSR0H
022C   30??           00934     movlw low frere_jacques
022D   0084           00935     movwf FSR0L
022E   3???           00936     bra joue
022F                  00937 musique_2:
022F   30??           00938     movlw high claire_fontaine
0230   0085           00939     movwf FSR0H
0231   30??           00940     movlw low claire_fontaine
0232   0084           00941     movwf FSR0L
0233   3???           00942     bra joue
0234                  00943 musique_1:
0234   30??           00944     movlw high melodia
0235   0085           00945     movwf FSR0H
0236   30??           00946     movlw low melodia
0237   0084           00947     movwf FSR0L
0238   3???           00948     bra joue
0239                  00949 musique_0:
0239   30??           00950     movlw high hymne_joie
023A   0085           00951     movwf FSR0H
023B   30??           00952     movlw low hymne_joie
023C   0084           00953     movwf FSR0L
023D                  00954 joue:    
023D   0012           00955     moviw FSR0++
                      00956     pushw
023E   001C               M     movwi ++FSR1
023F                  00957 notes_loop:
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

023F   0012           00958     moviw FSR0++ 
                      00959     pushw
0240   001C               M     movwi ++FSR1
0241   0012           00960     moviw FSR0++
                      00961     pushw
0242   001C               M     movwi ++FSR1
0243   0804           00962     movfw FSR0L ; sauvegarde FSR0
0244   00??           00963     movwf ACAL
0245   0805           00964     movfw FSR0H
0246   00??           00965     movwf ACAH
0247   2???           00966     call tone
0248   08??           00967     movfw ACAL ; restaure FSR0
0249   0084           00968     movwf FSR0L
024A   08??           00969     movfw ACAH
024B   0085           00970     movwf FSR0H
024C   300A           00971     movlw .10
024D   2???           00972     call pause_msec
Message[305]: Using default destination of 1 (file).
024E   0B81           00973     decfsz TOS
024F   3???           00974     bra notes_loop
                      00975     drop
0250   317F               M     addfsr FSR1,0x3f
Message[305]: Using default destination of 1 (file).
0251   0A??           00976     incf musique
0252   0008           00977     return
                      00978    
                      00979 ;;;;;;;;;;;;;;;;
                      00980 ;  tables
                      00981 ;;;;;;;;;;;;;;;;     
                      00982 ; connection des LED
                      00983 ; ordre inversé dans le montage final    
0253                  00984 LED_CONN: ; PORT data, TRIS data
0253   3400 34FF      00985     dt 0, 0xFF ; tous les segments éteints
0255   3408 34F3      00986     dt 1<<A10, ~(1<<C10 | 1<<A10)
0257   3404 34F3      00987     dt 1<<A9, ~(1<<C9 | 1<<A9)
0259   3404 34EB      00988     dt 1<<A8, ~(1<<C8 | 1<<A8)
025B   3404 34DB      00989     dt 1<<A7, ~(1<<C7 | 1<<A7)
025D   3402 34F5      00990     dt 1<<A6, ~(1<<C6 | 1<<A6)
025F   3402 34ED      00991     dt 1<<A5, ~(1<<C5 | 1<<A5)
0261   3402 34DD      00992     dt 1<<A4, ~(1<<C4 | 1<<A4)
0263   3401 34F6      00993     dt 1<<A3, ~(1<<C3 | 1<<A3)
0265   3401 34EE      00994     dt 1<<A2, ~(1<<C2 | 1<<A2)
0267   3401 34DE      00995     dt 1<<A1, ~(1<<C1 | 1<<A1)
0269   3400 34FF      00996     dt 0, 0xFF
026B   3400 34FF      00997     dt 0, 0xFF
026D   3400 34FF      00998     dt 0, 0xFF
026F   3400 34FF      00999     dt 0, 0xFF
0271   3400 34FF      01000     dt 0, 0xFF
                      01001 
                      01002 ;valeur de PR2 pour généré tonalités gamme tempéré
0273                  01003 SCALE:
0273   34EE           01004     dt .238 ;0: 523 DO
0274   34E1           01005     dt .225 ;1: 554 DO#
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0275   34D4           01006     dt .212 ;2: 587 RÉ
0276   34C8           01007     dt .200 ;3: 622 RÉ#
0277   34BD           01008     dt .189 ;4: 659 MI
0278   34B2           01009     dt .178 ;5: 698 FA
0279   34A8           01010     dt .168 ;6: 740 FA#
027A   349E           01011     dt .158 ;7: 784 SOL
027B   3495           01012     dt .149 ;8: 831 SOL#
027C   348D           01013     dt .141 ;9: 880 LA
027D   3485           01014     dt .133 ;10: 932 LA#
027E   347E           01015     dt .126 ;11: 988 SI
027F   3476           01016     dt .118 ;12: 1047 DO
0280   3470           01017     dt .112 ;13: 1109 DO#
0281   3469           01018     dt .105 ;14: 1175 RÉ
0282   3463           01019     dt .99  ;15: 1245 RÉ#
0283   345E           01020     dt .94  ;16: 1319 MI
0284   3458           01021     dt .88  ;17: 1397 FA
0285   3453           01022     dt .83  ;18: 1480 FA#
0286   344F           01023     dt .79  ;19: 1568 SOL
0287   344A           01024     dt .74  ;20: 1661 SOL#
0288   3446           01025     dt .70  ;21: 1760 LA
0289   3442           01026     dt .66  ;22: 1865 LA#
028A   343F           01027     dt .63  ;23: 1967 SI
028B   343B           01028     dt .59  ;24: 2093 DO
028C   3400           01029     dt 0    ;25  silence
                      01030 
028D                  01031 duree: ; durée des notes
                      01032     ; diviseur PS, temps
                      01033     
                      01034     
                      01035 ;5 première notes de rencontre du 3ième type
028D                  01036 ce3k:
028D   3406           01037     dt .6 ; nombre de notes
                      01038     ; durée, note
028E   3464 340E      01039     dt .100,.14
0290   3464 3410      01040     dt .100,.16
0292   3464 340C      01041     dt .100,.12
0294   3464 3400      01042     dt .100,.0
0296   34C8 3407      01043     dt .200,.7
0298   34C8 3407      01044     dt .200,.7
                      01045 
                      01046 ; 3 première note de la sonate au clair de lune
                      01047 ; de Beethoven
029A                  01048 soldomi:
029A   3403           01049     dt .3 
029B   3464 3407      01050     dt .100,.7   ;sol
029D   3464 340C      01051     dt .100,.12  ;do
029F   3464 3410      01052     dt .100,.16  ;mi
                      01053 
                      01054 ; partitions trouvées sur
                      01055 ; http://www.apprendrelaflute.com    
                      01056 ; hymne à la joie de Beethoven    
02A1                  01057 hymne_joie:
02A1   343E           01058     dt .62 ;nombre de notes
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01059 ; 1ière portée
02A2   3464 3409      01060     dt .100,.9   ; la
02A4   3464 3409      01061     dt .100,.9   ; la 
02A6   3464 340A      01062     dt .100,.10  ; si bémol
02A8   3464 340C      01063     dt .100,.12  ; do
02AA   3464 340C      01064     dt .100,.12  ; do
02AC   3464 340A      01065     dt .100,.10  ; si bémol
02AE   3464 3409      01066     dt .100,.9   ; la 
02B0   3464 3407      01067     dt .100,.7   ; sol
02B2   3464 3405      01068     dt .100,.5   ; fa
02B4   3464 3405      01069     dt .100,.5   ; fa
02B6   3464 3407      01070     dt .100,.7   ; sol
02B8   3464 3409      01071     dt .100,.9   ; la 
02BA   3496 3407      01072     dt .150,.7   ; sol
02BC   3432 3405      01073     dt .50,.5   ; fa
02BE   34C8 3405      01074     dt .200,.5   ; fa
                      01075 ;2ième portée
02C0   3464 3409      01076     dt .100,.9   ; la
02C2   3464 3409      01077     dt .100,.9   ; la 
02C4   3464 340A      01078     dt .100,.10  ; si bémol
02C6   3464 340C      01079     dt .100,.12  ; do
02C8   3464 340C      01080     dt .100,.12  ; do
02CA   3464 340A      01081     dt .100,.10  ; si bémol
02CC   3464 3409      01082     dt .100,.9   ; la 
02CE   3464 3407      01083     dt .100,.7   ; sol
02D0   3464 3405      01084     dt .100,.5   ; fa
02D2   3464 3405      01085     dt .100,.5   ; fa
02D4   3464 3407      01086     dt .100,.7   ; sol
02D6   3464 3409      01087     dt .100,.9   ; la 
02D8   3496 3407      01088     dt .150,.7   ; sol
02DA   3432 3405      01089     dt .50,.5   ; fa
02DC   34C8 3405      01090     dt .200,.5   ; fa
                      01091 ;3ième portée   
02DE   3464 3407      01092     dt .100,.7   ; sol
02E0   3464 3407      01093     dt .100,.7   ; sol
02E2   3464 3409      01094     dt .100,.9   ; la 
02E4   3464 3405      01095     dt .100,.5   ; fa
02E6   3464 3407      01096     dt .100,.7   ; sol
02E8   3432 3409      01097     dt .50,.9   ; la 
02EA   3432 340A      01098     dt .50,.10  ; si bémol
02EC   3464 3409      01099     dt .100,.9   ; la 
02EE   3464 3405      01100     dt .100,.5   ; fa
02F0   3464 3407      01101     dt .100,.7   ; sol
02F2   3432 3409      01102     dt .50,.9   ; la 
02F4   3432 340A      01103     dt .50,.10  ; si bémol
02F6   3464 3409      01104     dt .100,.9   ; la 
02F8   3464 3407      01105     dt .100,.7   ; sol
02FA   3464 3405      01106     dt .100,.5   ; fa
02FC   3464 3407      01107     dt .100,.7   ; sol
02FE   34C8 3400      01108     dt .200,.0   ; do
                      01109 ;4ième portée
0300   3464 3409      01110     dt .100,.9   ; la
0302   3464 3409      01111     dt .100,.9   ; la 
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0304   3464 340A      01112     dt .100,.10  ; si bémol
0306   3464 340C      01113     dt .100,.12  ; do
0308   3464 340C      01114     dt .100,.12  ; do
030A   3464 340C      01115     dt .100,.12  ; do
030C   3464 340A      01116     dt .100,.10  ; si bémol
030E   3464 3409      01117     dt .100,.9   ; la 
0310   3464 3407      01118     dt .100,.7   ; sol
0312   3464 3405      01119     dt .100,.5   ; fa
0314   3464 3405      01120     dt .100,.5   ; fa
0316   3464 3407      01121     dt .100,.7   ; sol
0318   3496 3407      01122     dt .150,.7   ; sol
031A   3432 3405      01123     dt .50,.5   ; fa
031C   34C8 3405      01124     dt .200,.5   ; fa
                      01125  
                      01126 ; mélodia (thème du film les jeux interdis)
031E                  01127 melodia:
031E   342B           01128     dt .43
                      01129 ;1ière portée
031F   3464 3409      01130     dt .100, .9 ; la
0321   3464 3409      01131     dt .100, .9 ; la
0323   3464 3409      01132     dt .100, .9 ; la
0325   3464 3409      01133     dt .100, .9 ; la
0327   3464 3407      01134     dt .100, .7 ; sol
0329   3464 3405      01135     dt .100, .5 ; fa
032B   3464 3405      01136     dt .100, .5 ; fa
032D   3464 3404      01137     dt .100, .4 ; mi
032F   3464 3402      01138     dt .100, .2 ; ré
0331   3464 3402      01139     dt .100, .2 ; ré
0333   3464 3405      01140     dt .100, .5 ; fa
0335   3464 3409      01141     dt .100, .9 ; la
                      01142 ;2ième portée
0337   3464 340E      01143     dt .100, .14 ; ré
0339   3464 340E      01144     dt .100, .14 ; ré
033B   3464 340E      01145     dt .100, .14 ; ré
033D   3464 340E      01146     dt .100, .14 ; ré
033F   3464 340C      01147     dt .100, .12 ; do
0341   3464 340A      01148     dt .100, .10 ; si bémol
0343   3464 340A      01149     dt .100, .10 ; si bémol
0345   3464 3409      01150     dt .100, .9 ; la
0347   3464 3407      01151     dt .100, .7 ; sol
0349   3464 3407      01152     dt .100, .7 ; sol
034B   3464 3409      01153     dt .100, .9 ; la
034D   3464 340A      01154     dt .100, .10 ; si bémol
                      01155 ;3ième portée
034F   3464 3409      01156     dt .100, .9 ; la
0351   3464 340A      01157     dt .100, .10 ; si bémol
0353   3464 3409      01158     dt .100, .9 ; la
0355   3464 340D      01159     dt .100, .13 ; do#
0357   3464 340A      01160     dt .100, .10 ; si bémol
0359   3464 3409      01161     dt .100, .9 ; la
035B   3464 3409      01162     dt .100, .9 ; la
035D   3464 3407      01163     dt .100, .7 ; sol
035F   3464 3405      01164     dt .100, .5 ; fa
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01165 ;4ième portée
0361   3464 3405      01166     dt .100, .5 ; fa
0363   3464 3404      01167     dt .100, .4 ; mi
0365   3464 3402      01168     dt .100, .2 ; ré
0367   3464 3404      01169     dt .100, .4 ; mi
0369   3464 3404      01170     dt .100, .4 ; mi
036B   3464 3404      01171     dt .100, .4 ; mi
036D   3464 3404      01172     dt .100, .4 ; mi
036F   3464 3405      01173     dt .100, .5 ; fa
0371   3464 3404      01174     dt .100, .4 ; mi
0373   34FF 3402      01175     dt .255, .2 ; ré
                      01176 
                      01177 ; à la claire fontaine    
0375                  01178 claire_fontaine:
                      01179 ;1ière portée
0375   3429           01180     dt .41
0376   34C8 3407      01181     dt .200, .7  ; sol
0378   3464 3407      01182     dt .100, .7  ; sol
037A   3464 340B      01183     dt .100, .11 ; si
037C   3464 340B      01184     dt .100, .11 ; si
037E   3464 3409      01185     dt .100, .9  ; la
0380   3464 340B      01186     dt .100, .11 ; si
0382   3464 3407      01187     dt .100, .7  ; sol
0384   34C8 3407      01188     dt .200, .7  ; sol
0386   3464 3407      01189     dt .100, .7  ; sol
0388   3464 340B      01190     dt .100, .11 ; si
038A   3464 340B      01191     dt .100, .11 ; si
038C   3464 3409      01192     dt .100, .9  ; la
038E   34C8 340B      01193     dt .200, .11 ; si
                      01194 ;2ième portée
0390   34C8 340B      01195     dt .200, .11 ; si
0392   3464 340B      01196     dt .100, .11 ; si
0394   3464 3409      01197     dt .100, .9  ; la
0396   3464 3407      01198     dt .100, .7  ; sol
0398   3464 340B      01199     dt .100, .11 ; si
039A   3464 340E      01200     dt .100, .14 ; ré
039C   3464 340B      01201     dt .100, .11 ; si
039E   34C8 340E      01202     dt .200, .14 ; ré
03A0   3464 340E      01203     dt .100, .14 ; ré
03A2   3464 340B      01204     dt .100, .11 ; si
03A4   3464 3407      01205     dt .100, .7  ; sol
03A6   3464 340B      01206     dt .100, .11 ; si
03A8   34C8 3409      01207     dt .200, .9  ; la
                      01208 ;3ième portée
03AA   34C8 3407      01209     dt .200, .7  ; sol
03AC   3464 3407      01210     dt .100, .7  ; sol
03AE   3464 340B      01211     dt .100, .11 ; si
03B0   3464 340B      01212     dt .100, .11 ; si
03B2   3432 3409      01213     dt .50, .9   ; la
03B4   3432 3407      01214     dt .50, .7   ; sol
03B6   3464 340B      01215     dt .100, .11 ; si
03B8   3464 3407      01216     dt .100, .7  ; sol
03BA   34C8 340B      01217     dt .200, .11 ; si
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

03BC   3464 340B      01218     dt .100, .11 ; si
03BE   3432 3409      01219     dt .50, .9  ; la
03C0   3432 3407      01220     dt .50, .7  ; sol
03C2   3464 340B      01221     dt .100, .11 ; si
03C4   3464 3409      01222     dt .100, .9  ; la
03C6   34C8 3407      01223     dt .200, .7  ; sol
                      01224     
                      01225 ;frère Jacques
03C8                  01226 frere_jacques:    
03C8   3420           01227     dt .32
                      01228 ;1ière portée
03C9   3464 3405      01229     dt .100, .5 ; fa
03CB   3464 3407      01230     dt .100, .7  ; sol
03CD   3464 3409      01231     dt .100, .9   ; la
03CF   3464 3405      01232     dt .100, .5 ; fa
                      01233     
03D1   3464 3405      01234     dt .100, .5 ; fa
03D3   3464 3407      01235     dt .100, .7  ; sol
03D5   3464 3409      01236     dt .100, .9   ; la
03D7   3464 3405      01237     dt .100, .5 ; fa
                      01238  
03D9   3464 3409      01239     dt .100, .9   ; la
03DB   3464 340A      01240     dt .100, .10 ; si bémol
03DD   34C8 340C      01241     dt .200, .12 ; do
                      01242     
03DF   3464 3409      01243     dt .100, .9   ; la
03E1   3464 340A      01244     dt .100, .10 ; si bémol
03E3   34C8 340C      01245     dt .200, .12 ; do
                      01246 ;2ième portée    
03E5   344B 340C      01247     dt .75,  .12 ; do
03E7   3419 340E      01248     dt .25,  .14 ; ré
03E9   3432 340C      01249     dt .50,  .12 ; do
03EB   3432 340A      01250     dt .50,  .10 ; si bémol
03ED   3464 3409      01251     dt .100, .9  ; la
03EF   3464 3405      01252     dt .100, .5  ; fa
                      01253 
03F1   344B 340C      01254     dt .75,  .12 ; do
03F3   3419 340E      01255     dt .25,  .14 ; ré
03F5   3432 340C      01256     dt .50,  .12 ; do
03F7   3432 340A      01257     dt .50,  .10 ; si bémol
03F9   3464 3409      01258     dt .100, .9  ; la
03FB   3464 3405      01259     dt .100, .5  ; fa
                      01260 
03FD   3464 3405      01261     dt .100, .5  ; fa
03FF   3464 340C      01262     dt .100, .12 ; do
0401   34C8 3405      01263     dt .200, .5  ; fa
                      01264 
0403   3464 3405      01265     dt .100, .5   ; fa
0405   3464 340C      01266     dt .100,  .12 ; do
0407   34C8 3405      01267     dt .200, .5   ; fa
                      01268 
                      01269 ;J'ai du bon tabac dans ma tabatière
0409                  01270 bon_tabac:
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0409   341E           01271     dt .30
                      01272 ;1ière portée
040A   3464 3407      01273     dt .100, .7  ; sol
040C   3464 3409      01274     dt .100, .9   ; la
040E   3464 340B      01275     dt .100, .11 ; si
0410   3464 3407      01276     dt .100, .7  ; sol
                      01277     
0412   34C8 3409      01278     dt .200, .9   ; la
0414   3464 3409      01279     dt .100, .9   ; la
0416   3464 340B      01280     dt .100, .11 ; si
                      01281     
0418   34C8 340C      01282     dt .200,  .12 ; do
041A   34C8 340C      01283     dt .200,  .12 ; do
                      01284     
041C   34C8 340B      01285     dt .200, .11 ; si
041E   34C8 340B      01286     dt .200, .11 ; si
                      01287 ;2ième portée
0420   3464 3407      01288     dt .100, .7  ; sol
0422   3464 3409      01289     dt .100, .9   ; la
0424   3464 340B      01290     dt .100, .11 ; si
0426   3464 3407      01291     dt .100, .7  ; sol
                      01292     
0428   34C8 3409      01293     dt .200, .9   ; la
042A   3464 3409      01294     dt .100, .9   ; la
042C   3464 340B      01295     dt .100, .11 ; si
                      01296     
042E   34C8 340C      01297     dt .200,  .12 ; do
0430   34C8 340E      01298     dt .200,  .14 ; ré
                      01299     
0432   34FF 3407      01300     dt .255,  .7  ; sol
                      01301 ;3ième portée
0434   34C8 340E      01302     dt .200,  .14 ; ré
0436   3464 340E      01303     dt .100,  .14 ; ré
0438   3464 340C      01304     dt .100,  .12 ; do
                      01305        
043A   34C8 340B      01306     dt .200, .11 ; si
043C   3464 3409      01307     dt .100, .9   ; la
043E   3464 340B      01308     dt .100, .11 ; si
                      01309  
0440   34C8 340C      01310     dt .200,  .12 ; do
0442   34C8 340E      01311     dt .200,  .14 ; ré
                      01312     
0444   34FF 3409      01313     dt .255,  .9  ; la    
                      01314 
                      01315 ; god save de queen    
0446                  01316 gstq:    
0446   3429           01317     dt .41
                      01318 ;1ère portée    
0447   3464 340C      01319     dt .100, .12 ; do
0449   3464 340C      01320     dt .100, .12 ; do
044B   3464 340E      01321     dt .100, .14 ; ré
                      01322     
044D   3496 340B      01323     dt .150, .11 ; si
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

044F   3432 340C      01324     dt .50,  .12 ; do
0451   3464 340E      01325     dt .100, .14 ; ré
                      01326     
0453   3464 3410      01327     dt .100, .16 ; mi
0455   3464 3410      01328     dt .100, .16 ; mi
0457   3464 3411      01329     dt .100, .17 ; fa
                      01330     
0459   3496 3410      01331     dt .150, .16 ; mi
045B   3432 340E      01332     dt .50,  .14 ; ré
045D   3464 340C      01333     dt .100, .12 ; do
                      01334 
                      01335 ;2ième portée
045F   3464 340E      01336     dt .100, .14 ; ré
0461   3464 340C      01337     dt .100, .12 ; do
0463   3464 340B      01338     dt .100, .11 ; si
                      01339     
0465   34FF 340C      01340     dt .255, .12 ; do
                      01341     
0467   3464 3413      01342     dt .100, .19 ; sol
0469   3464 3413      01343     dt .100, .19 ; sol
046B   3464 3413      01344     dt .100, .19 ; sol
                      01345 
046D   3496 3413      01346     dt .150, .19 ; sol
046F   3432 3411      01347     dt .50,  .17 ; fa
0471   3464 3410      01348     dt .100, .16 ; mi
                      01349     
                      01350 ;3ième portée
0473   3464 3411      01351     dt .100, .17 ; fa
0475   3464 3411      01352     dt .100, .17 ; fa
0477   3464 3411      01353     dt .100, .17 ; fa
                      01354 
0479   3496 3411      01355     dt .150, .17 ; fa
047B   3432 3410      01356     dt .50,  .16 ; mi
047D   3464 340E      01357     dt .100, .14 ; ré
                      01358     
047F   3464 3410      01359     dt .100, .16 ; mi
0481   3432 3411      01360     dt .50,  .17 ; fa
0483   3432 3410      01361     dt .50,  .16 ; mi
0485   3432 340E      01362     dt .50,  .14 ; ré
0487   3432 340C      01363     dt .50,  .12 ; do
                      01364     
0489   3496 3410      01365     dt .150, .16 ; mi
048B   3432 3411      01366     dt .50,  .17 ; fa
048D   3464 3413      01367     dt .100, .19 ; sol
                      01368     
                      01369 ;4ième portée
048F   3432 3415      01370     dt .50,  .21 ; la
0491   3432 3411      01371     dt .50,  .17 ; fa
0493   3464 3410      01372     dt .100, .16 ; mi
0495   3464 340E      01373     dt .100, .14 ; ré
                      01374     
0497   34FF 340C      01375     dt .255, .12 ; do
                      01376 
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01377 ;greensleeves
0499                  01378 greensleeves:
0499   3448           01379     dt .72
                      01380 ;1ière portée
                      01381 ;    dt .100, .25  ; silence
                      01382 ;    dt .100, .25  ; silence
049A   3464 340E      01383     dt .100, .14  ; ré
                      01384     
049C   34C8 3411      01385     dt .200, .17  ; fa
049E   3464 3413      01386     dt .100, .19  ; sol
                      01387     
04A0   3496 3415      01388     dt .150, .21  ; la
04A2   3432 3414      01389     dt .50,  .20  ; si bémol
04A4   3464 3415      01390     dt .100, .21  ; la
                      01391     
04A6   34C8 3413      01392     dt .200, .19  ; sol
04A8   3464 3410      01393     dt .100, .16  ; mi
                      01394     
04AA   3496 340C      01395     dt .150, .12  ; do
04AC   3432 340E      01396     dt .50,  .14  ; ré
04AE   3464 3410      01397     dt .100, .16  ; mi
                      01398     
04B0   34C8 3411      01399     dt .200, .17  ; fa
04B2   3464 340E      01400     dt .100, .14  ; ré
                      01401 ;2ième portée
04B4   3496 340E      01402     dt .150, .14  ; ré
04B6   3432 340D      01403     dt .50,  .13  ; do#
04B8   3464 340E      01404     dt .100, .14  ; ré
                      01405     
04BA   34C8 3410      01406     dt .200, .16  ; mi
04BC   3464 340D      01407     dt .100, .13  ; do#
                      01408     
04BE   34C8 3409      01409     dt .200, .9   ; la
04C0   3464 340E      01410     dt .100, .14  ; ré
                      01411     
04C2   34C8 3411      01412     dt .200, .17  ; fa
04C4   3464 3413      01413     dt .100, .19  ; sol
                      01414     
04C6   3496 3415      01415     dt .150, .21  ; la
04C8   3432 3414      01416     dt .50,  .20  ; si bémol
04CA   3464 3415      01417     dt .100, .21  ; la
                      01418     
04CC   34C8 3413      01419     dt .200, .19  ; sol
04CE   3464 3410      01420     dt .100, .16  ; mi
                      01421 ;3ième portée
04D0   3496 340C      01422     dt .150, .12  ; do
04D2   3432 340E      01423     dt .50,  .14  ; ré
04D4   3464 3410      01424     dt .100, .16  ; mi
                      01425     
04D6   3496 3411      01426     dt .150, .17  ; fa
04D8   3432 3410      01427     dt .50,  .16  ; mi
04DA   3464 340E      01428     dt .100, .14  ; ré
                      01429     
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

04DC   3496 340D      01430     dt .150, .13  ; do#
04DE   3432 340B      01431     dt .50,  .11  ; si
04E0   3464 340D      01432     dt .100, .13  ; do#
                      01433     
04E2   34C8 340E      01434     dt .200, .14  ; ré
04E4   3464 340E      01435     dt .100, .14  ; ré
                      01436     
04E6   34FF 3418      01437     dt .255, .24  ; do  devrait-être .300, .24
                      01438 ;    dt .45,  .25  ; problème
                      01439     
04E8   3496 3418      01440     dt .150, .24  ; do
04EA   3432 3417      01441     dt .50,  .23  ; si
04EC   3464 3415      01442     dt .100, .21  ; la
                      01443     
04EE   34C8 3413      01444     dt .200, .19  ; sol
04F0   3464 3410      01445     dt .100, .16  ; mi
                      01446 ;4ième portée
04F2   3496 340C      01447     dt .150, .12  ; do
04F4   3432 340E      01448     dt .50,  .14  ; ré
04F6   3464 3410      01449     dt .100, .16  ; mi
                      01450     
04F8   34C8 3411      01451     dt .200, .17  ; fa
04FA   3464 340E      01452     dt .100, .14  ; ré
                      01453     
04FC   3496 340E      01454     dt .150, .14  ; ré
04FE   3432 340D      01455     dt .50,  .13  ; do#
0500   3464 340E      01456     dt .100, .14  ; ré
                      01457     
0502   34C8 3410      01458     dt .200, .16  ; mi
0504   3464 340D      01459     dt .100, .13  ; do#
                      01460     
0506   34FF 3409      01461     dt .255, .9   ; la
                      01462  ;   dt .45,  .25  ; silence
                      01463     
0508   34FF 3418      01464     dt .255, .24  ; do
                      01465 ;    dt .45,  .25  ; silence
                      01466     
050A   3496 3418      01467     dt .150, .24  ; do
050C   3432 3417      01468     dt .50,  .23  ; si
050E   3464 3415      01469     dt .100, .21  ; la
                      01470     
0510   34C8 3413      01471     dt .200, .19  ; sol
0512   3464 3410      01472     dt .100, .16  ; mi
                      01473     
0514   3496 340C      01474     dt .150, .12  ; do
0516   3432 340E      01475     dt .50,  .14  ; ré
0518   3464 3410      01476     dt .100, .16  ; mi
                      01477     
051A   3496 3411      01478     dt .150, .17  ; fa
051C   3432 3410      01479     dt .50,  .16  ; mi
051E   3464 340E      01480     dt .100, .14  ; ré
                      01481     
0520   3496 340D      01482     dt .150, .13  ; do#
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0522   3432 340B      01483     dt .50,  .11  ; si
0524   3464 340D      01484     dt .100, .13  ; do#
                      01485     
0526   34FF 340E      01486     dt .255, .14  ; ré
                      01487 ;    dt .45,  .25  ; silence
                      01488     
0528   34FF 340E      01489     dt .255, .14  ; ré
                      01490     
                      01491     
052A                  01492 KORO: ; Korobeiniki, ref: https://commons.wikimedia.org/wiki/File:Korobeiniki_Music.png?uselang=fr
052A   3422           01493     dt .34
052B   3496 3404      01494     dt .150,.4 ; mi
052D   3432 3408      01495     dt .50,.8 ; sol#
052F   3464 340B      01496     dt .100,.11 ; si
0531   3432 3407      01497     dt .50,.7 ; sol
0533   3432 3404      01498     dt .50,.4 ; mi
0535   3496 3409      01499     dt .150,.9 ; la
0537   3432 340C      01500     dt .50,.12 ; do
0539   3464 3410      01501     dt .100,.16 ; mi
053B   3432 340E      01502     dt .50,.14 ; ré
053D   3432 340C      01503     dt .50,.12 ; do
053F   3496 340B      01504     dt .150,.11 ; si
0541   3432 340C      01505     dt .50,.12 ; do
0543   3464 340E      01506     dt .100,.14 ; ré
0545   3464 3410      01507     dt .100,.16 ; mi
0547   3464 340C      01508     dt .100,.12 ; do
0549   3464 3409      01509     dt .100,.9 ; la
054B   34C8 3409      01510     dt .200,.9 ; la
054D   3496 3411      01511     dt .150,.17 ; fa
054F   3432 3413      01512     dt .50,.19 ; sol
0551   3464 3415      01513     dt .100,.21 ; la
0553   3432 3413      01514     dt .50,.19 ; sol
0555   3432 3411      01515     dt .50,.17 ; fa
0557   3496 3410      01516     dt .150,.16 ; mi
0559   3432 3411      01517     dt .50,.17 ; fa
055B   3464 3410      01518     dt .100,.16 ; mi
055D   3432 340E      01519     dt .50,.14 ; ré
055F   3432 340C      01520     dt .50,.12 ; do
0561   3496 340B      01521     dt .150,.11 ; si
0563   3432 340C      01522     dt .50,.12 ; do
0565   3464 340E      01523     dt .100,.14 ; ré
0567   3464 3410      01524     dt .100,.16 ; mi
0569   3464 340C      01525     dt .100,.12 ; do
056B   3464 3409      01526     dt .100,.9 ; la
056D   34C8 3409      01527     dt .200,.9 ; la
                      01528     
                      01529     
                      01530 ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;    
39E4 1E7F             01531     end
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 33


SYMBOL TABLE
  LABEL                             VALUE 

A1                                RC0
A10                               RC3
A2                                RC0
A3                                RC0
A4                                RC1
A5                                RC1
A6                                RC1
A7                                RC2
A8                                RC2
A9                                RC2
ACAH                              00000001
ACAL                              00000000
ACBH                              00000003
ACBL                              00000002
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACKTIM                            00000007
ADCON0                            0000009D
ADCON1                            0000009E
ADCON2                            0000009F
ADD0                              00000000
ADD1                              00000001
ADD2                              00000002
ADD3                              00000003
ADD4                              00000004
ADD5                              00000005
ADD6                              00000006
ADD7                              00000007
ADFM                              00000007
ADFVR0                            00000000
ADFVR1                            00000001
ADGO                              00000001
ADIE                              00000006
ADIF                              00000006
ADNREF                            00000002
ADON                              00000000
ADPREF0                           00000000
ADPREF1                           00000001
ADRES                             0000009B
ADRESH                            0000009C
ADRESL                            0000009B
AHEN                              00000001
ALARM_TABLE                       soldomi
ANSA0                             00000000
ANSA1                             00000001
ANSA2                             00000002
ANSA4                             00000004
ANSC0                             00000000
ANSC1                             00000001
ANSC2                             00000002
ANSC3                             00000003
ANSC4                             00000004
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 34


SYMBOL TABLE
  LABEL                             VALUE 

ANSC5                             00000005
ANSELA                            0000018C
ANSELC                            0000018E
BCL1IE                            00000003
BCL1IF                            00000003
BF                                00000000
BKA10                             00000002
BKA11                             00000003
BKA12                             00000004
BKA13                             00000005
BKA14                             00000006
BKA8                              00000000
BKA9                              00000001
BOEN                              00000004
BORCON                            00000116
BORFS                             00000006
BORRDY                            00000000
BSR                               00000008
BSR0                              00000000
BSR1                              00000001
BSR2                              00000002
BSR3                              00000003
BSR4                              00000004
BSR_SHAD                          00000FE6
BTN_PORT                          PORTA
BTN_TRIS                          TRISA
BTN_WPU                           WPUA
BUF0                              00000000
BUF1                              00000001
BUF2                              00000002
BUF3                              00000003
BUF4                              00000004
BUF5                              00000005
BUF6                              00000006
BUF7                              00000007
C                                 00000000
C1                                RC5
C10                               RC2
C2                                RC4
C3                                RC3
C4                                RC5
C5                                RC4
C6                                RC3
C7                                RC5
C8                                RC4
C9                                RC3
CCP1CON                           00000293
CCP1IE                            00000002
CCP1IF                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 35


SYMBOL TABLE
  LABEL                             VALUE 

CCP1PPS                           00000E14
CCP1X                             00000005
CCP1Y                             00000004
CCP2CON                           0000029A
CCP2IE                            00000000
CCP2IF                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2PPS                           00000E15
CCP2X                             00000005
CCP2Y                             00000004
CCPIE                             00000002
CCPIF                             00000002
CCPR1                             00000291
CCPR1H                            00000292
CCPR1L                            00000291
CCPR2                             00000298
CCPR2H                            00000299
CCPR2L                            00000298
CDAFVR0                           00000002
CDAFVR1                           00000003
CFGS                              00000006
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CHS4                              00000006
CKE                               00000006
CKP                               00000004
C_SHAD                            00000000
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DC_SHAD                           00000001
DHEN                              00000000
DISPLAY                           PORTC
DISP_LAT                          LATC
DISP_TRIS                         TRISC
DISP_WPU                          WPUC
DIVIDENDE                         ACAL
DIVISEUR                          ACBL
D_NOT_A                           00000005
ECCP1CON                          00000293
ECCP2CON                          0000029A
F                                 00000001
F2MHZ                             0000000C
F8MHZ                             0000000E
FREE                              00000004
FSR0                              00000004
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 36


SYMBOL TABLE
  LABEL                             VALUE 

FSR0H                             00000005
FSR0H_SHAD                        00000FE9
FSR0L                             00000004
FSR0L_SHAD                        00000FE8
FSR1                              00000006
FSR1H                             00000007
FSR1H_SHAD                        00000FEB
FSR1L                             00000006
FSR1L_SHAD                        00000FEA
FVRCON                            00000117
FVREN                             00000007
FVRRDY                            00000006
F_MSEC4                           1
F_SEC                             0
GCEN                              00000007
GIE                               00000007
GO                                00000001
GO_NOT_DONE                       00000001
HFIOFL                            00000003
HFIOFR                            00000004
HFIOFS                            00000000
ICDBK0H                           00000F9E
INDF0                             00000000
INDF1                             00000001
INLVLA                            0000038C
INLVLA0                           00000000
INLVLA1                           00000001
INLVLA2                           00000002
INLVLA3                           00000003
INLVLA4                           00000004
INLVLA5                           00000005
INLVLC                            0000038E
INLVLC0                           00000000
INLVLC1                           00000001
INLVLC2                           00000002
INLVLC3                           00000003
INLVLC4                           00000004
INLVLC5                           00000005
INTCON                            0000000B
INTE                              00000004
INTEDG                            00000006
INTF                              00000001
INTPPS                            00000E10
IOCAF                             00000393
IOCAF0                            00000000
IOCAF1                            00000001
IOCAF2                            00000002
IOCAF3                            00000003
IOCAF4                            00000004
IOCAF5                            00000005
IOCAN                             00000392
IOCAN0                            00000000
IOCAN1                            00000001
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 37


SYMBOL TABLE
  LABEL                             VALUE 

IOCAN2                            00000002
IOCAN3                            00000003
IOCAN4                            00000004
IOCAN5                            00000005
IOCAP                             00000391
IOCAP0                            00000000
IOCAP1                            00000001
IOCAP2                            00000002
IOCAP3                            00000003
IOCAP4                            00000004
IOCAP5                            00000005
IOCCF                             00000399
IOCCF0                            00000000
IOCCF1                            00000001
IOCCF2                            00000002
IOCCF3                            00000003
IOCCF4                            00000004
IOCCF5                            00000005
IOCCN                             00000398
IOCCN0                            00000000
IOCCN1                            00000001
IOCCN2                            00000002
IOCCN3                            00000003
IOCCN4                            00000004
IOCCN5                            00000005
IOCCP                             00000397
IOCCP0                            00000000
IOCCP1                            00000001
IOCCP2                            00000002
IOCCP3                            00000003
IOCCP4                            00000004
IOCCP5                            00000005
IOCIE                             00000003
IOCIF                             00000000
IRCF0                             00000003
IRCF1                             00000004
IRCF2                             00000005
IRCF3                             00000006
KORO                              0000052A
LATA                              0000010C
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA4                             00000004
LATA5                             00000005
LATC                              0000010E
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC3                             00000003
LATC4                             00000004
LATC5                             00000005
LED_CONN                          00000253
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 38


SYMBOL TABLE
  LABEL                             VALUE 

LFIOFR                            00000001
LWLO                              00000005
MFIOFR                            00000002
MSK0                              00000000
MSK1                              00000001
MSK2                              00000002
MSK3                              00000003
MSK4                              00000004
MSK5                              00000005
MSK6                              00000006
MSK7                              00000007
NOMBRE_MELODIES                   00000009
NOT_BOR                           00000000
NOT_PD                            00000003
NOT_POR                           00000001
NOT_RI                            00000002
NOT_RMCLR                         00000003
NOT_RWDT                          00000004
NOT_T1SYNC                        00000002
NOT_TO                            00000004
NOT_WPUEN                         00000007
ODA0                              00000000
ODA1                              00000001
ODA2                              00000002
ODA4                              00000004
ODA5                              00000005
ODC0                              00000000
ODC1                              00000001
ODC2                              00000002
ODC3                              00000003
ODC4                              00000004
ODC5                              00000005
ODCONA                            0000028C
ODCONC                            0000028E
OPA1CON                           00000511
OPA1EN                            00000007
OPA1PCH0                          00000000
OPA1PCH1                          00000001
OPA1SP                            00000006
OPA1UG                            00000004
OPA2CON                           00000515
OPA2EN                            00000007
OPA2PCH0                          00000000
OPA2PCH1                          00000001
OPA2SP                            00000006
OPA2UG                            00000004
OPTION_REG                        00000095
OSCCON                            00000099
OSCSTAT                           0000009A
OSCTUNE                           00000098
OSTS                              00000005
P                                 00000004
PCIE                              00000006
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 39


SYMBOL TABLE
  LABEL                             VALUE 

PCL                               00000002
PCLATH                            0000000A
PCLATH_SHAD                       00000FE7
PCON                              00000096
PEIE                              00000006
PEN                               00000002
PIE1                              00000091
PIE2                              00000092
PIE3                              00000093
PIR1                              00000011
PIR2                              00000012
PIR3                              00000013
PLLR                              00000006
PMADR                             00000191
PMADRH                            00000192
PMADRL                            00000191
PMCON1                            00000195
PMCON2                            00000196
PMDAT                             00000193
PMDATH                            00000194
PMDATL                            00000193
PORTA                             0000000C
PORTC                             0000000E
PPSLOCK                           00000E0F
PPSLOCKED                         00000000
PR2                               0000001B
PS0                               00000000
PS1                               00000001
PS2                               00000002
PSA                               00000003
QUOTIENT                          ACAH
RA0                               00000000
RA0PPS                            00000E90
RA1                               00000001
RA1PPS                            00000E91
RA2                               00000002
RA2PPS                            00000E92
RA3                               00000003
RA4                               00000004
RA4PPS                            00000E94
RA5                               00000005
RA5PPS                            00000E95
RC0                               00000000
RC0PPS                            00000EA0
RC1                               00000001
RC1PPS                            00000EA1
RC2                               00000002
RC2PPS                            00000EA2
RC3                               00000003
RC3PPS                            00000EA3
RC4                               00000004
RC4PPS                            00000EA4
RC5                               00000005
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 40


SYMBOL TABLE
  LABEL                             VALUE 

RC5PPS                            00000EA5
RCEN                              00000003
RD                                00000000
RESTE                             ACAL
RSEN                              00000001
R_NOT_W                           00000002
Reserved                          00000000
S                                 00000003
SBCDE                             00000002
SBOREN                            00000007
SCALE                             00000273
SCIE                              00000005
SCS0                              00000000
SCS1                              00000001
SDAHT                             00000003
SEN                               00000000
SERVO_CCPCON                      CCP2CON
SERVO_CCPRL                       CCPR2L
SERVO_DLY                         00000003
SERVO_LAT                         LATA
SERVO_NEUTRAL_PULSE               0000002F
SERVO_OUT_FN                      H'D'
SERVO_PERIOD                      0000009B
SERVO_PIN                         RA2
SERVO_PIN_PPS                     RA2PPS
SERVO_POS_BAS                     0000002F
SERVO_POS_HAUT                    0000003C
SERVO_TRIS                        TRISA
SERVO_WPU                         WPUA
SLRA0                             00000000
SLRA1                             00000001
SLRA2                             00000002
SLRA4                             00000004
SLRA5                             00000005
SLRC0                             00000000
SLRC1                             00000001
SLRC2                             00000002
SLRC3                             00000003
SLRC4                             00000004
SLRC5                             00000005
SLRCONA                           0000030C
SLRCONC                           0000030E
SMP                               00000007
SOSCR                             00000007
SPLLEN                            00000007
SSP1ADD                           00000212
SSP1ADD0                          00000000
SSP1ADD1                          00000001
SSP1ADD2                          00000002
SSP1ADD3                          00000003
SSP1ADD4                          00000004
SSP1ADD5                          00000005
SSP1ADD6                          00000006
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 41


SYMBOL TABLE
  LABEL                             VALUE 

SSP1ADD7                          00000007
SSP1BUF                           00000211
SSP1BUF0                          00000000
SSP1BUF1                          00000001
SSP1BUF2                          00000002
SSP1BUF3                          00000003
SSP1BUF4                          00000004
SSP1BUF5                          00000005
SSP1BUF6                          00000006
SSP1BUF7                          00000007
SSP1CON                           00000215
SSP1CON1                          00000215
SSP1CON2                          00000216
SSP1CON3                          00000217
SSP1IE                            00000003
SSP1IF                            00000003
SSP1MSK                           00000213
SSP1MSK0                          00000000
SSP1MSK1                          00000001
SSP1MSK2                          00000002
SSP1MSK3                          00000003
SSP1MSK4                          00000004
SSP1MSK5                          00000005
SSP1MSK6                          00000006
SSP1MSK7                          00000007
SSP1STAT                          00000214
SSPADD                            00000212
SSPBUF                            00000211
SSPCLKPPS                         00000E20
SSPCON                            00000215
SSPCON1                           00000215
SSPCON2                           00000216
SSPCON3                           00000217
SSPDATPPS                         00000E21
SSPEN                             00000005
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPMSK                            00000213
SSPOV                             00000006
SSPSSPPS                          00000E22
SSPSTAT                           00000214
START_IOCF                        IOCAF
START_IOCN                        IOCAN
START_PIN                         RA5
START_PORT                        PORTA
START_TRIS                        TRISA
STATUS                            00000003
STATUS_SHAD                       00000FE4
STKOVF                            00000007
STKPTR                            00000FED
STKUNF                            00000006
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 42


SYMBOL TABLE
  LABEL                             VALUE 

SWDTEN                            00000000
T0CKIPPS                          00000E11
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0SE                              00000004
T1CKIPPS                          00000E12
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000018
T1GCON                            00000019
T1GGO_NOT_DONE                    00000003
T1GPOL                            00000006
T1GPPS                            00000E13
T1GSPM                            00000004
T1GSS0                            00000000
T1GSS1                            00000001
T1GTM                             00000005
T1GVAL                            00000002
T1OSCEN                           00000003
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             0000001C
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
TIMESET_PIN                       RA4
TIMESET_PORT                      PORTA
TIMESET_TRIS                      TRISA
TIME_INCR                         00000EA6
TIME_MAX                          0000927C
TMR0                              00000015
TMR0CS                            00000005
TMR0IE                            00000005
TMR0IF                            00000002
TMR0SE                            00000004
TMR0_DLY                          00000006
TMR1                              00000016
TMR1CS0                           00000006
TMR1CS1                           00000007
TMR1GE                            00000007
TMR1GIE                           00000007
TMR1GIF                           00000007
TMR1H                             00000017
TMR1IE                            00000000
TMR1IF                            00000000
TMR1L                             00000016
TMR1ON                            00000000
TMR1_DLY                          00008300
TMR2                              0000001A
TMR2IE                            00000001
TMR2IF                            00000001
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 43


SYMBOL TABLE
  LABEL                             VALUE 

TMR2ON                            00000002
TONE_CCPCON                       CCP1CON
TONE_CCPRL                        CCPR1L
TONE_LAT                          LATA
TONE_OUT_FN                       H'C'
TONE_PIN                          RA1
TONE_PIN_PPS                      RA1PPS
TONE_TRIS                         TRISA
TONE_WPU                          WPUA
TOS                               INDF1
TOSH                              00000FEF
TOSL                              00000FEE
TRIGSEL0                          00000004
TRIGSEL1                          00000005
TRIGSEL2                          00000006
TRIGSEL3                          00000007
TRISA                             0000008C
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA4                            00000004
TRISA5                            00000005
TRISC                             0000008E
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC3                            00000003
TRISC4                            00000004
TRISC5                            00000005
TSEN                              00000005
TSRNG                             00000004
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TUN5                              00000005
UA                                00000001
VREGCON                           00000197
VREGPM                            00000001
W                                 00000000
WCOL                              00000007
WDTCON                            00000097
WDTPS0                            00000001
WDTPS1                            00000002
WDTPS2                            00000003
WDTPS3                            00000004
WDTPS4                            00000005
WPUA                              0000020C
WPUA0                             00000000
WPUA1                             00000001
WPUA2                             00000002
WPUA3                             00000003
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 44


SYMBOL TABLE
  LABEL                             VALUE 

WPUA4                             00000004
WPUA5                             00000005
WPUC                              0000020E
WPUC0                             00000000
WPUC1                             00000001
WPUC2                             00000002
WPUC3                             00000003
WPUC4                             00000004
WPUC5                             00000005
WR                                00000001
WREG                              00000009
WREG_SHAD                         00000FE5
WREN                              00000002
WRERR                             00000003
Z                                 00000002
ZCD1CON                           0000011C
ZCD1EN                            00000007
ZCD1INTN                          00000000
ZCD1INTP                          00000001
ZCD1OUT                           00000005
ZCD1POL                           00000004
ZCDIE                             00000004
ZCDIF                             00000004
Z_SHAD                            00000002
_.org_1_0080                      00000080
_.org_1_0096                      00000096
_.org_1_00AE                      000000AE
_.org_1_00B0                      000000B0
_.org_1_0102                      00000102
_.org_1_010C                      0000010C
_.org_1_0115                      00000115
_.org_1_0151                      00000151
_.org_1_0164                      00000164
_.org_1_01B0                      000001B0
_BOREN_NSLEEP                     00003DFF
_BOREN_OFF                        000039FF
_BOREN_ON                         00003FFF
_BOREN_SBODEN                     00003BFF
_BORV_HI                          00003BFF
_BORV_LO                          00003FFF
_CLKOUTEN_OFF                     00003FFF
_CLKOUTEN_ON                      000037FF
_CONFIG1                          00008007
_CONFIG2                          00008008
_CP_OFF                           00003FFF
_CP_ON                            00003F7F
_DEVID1                           00008006
_FOSC_ECH                         00003FFF
_FOSC_ECL                         00003FFD
_FOSC_ECM                         00003FFE
_FOSC_INTOSC                      00003FFC
_IDLOC0                           00008000
_IDLOC1                           00008001
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 45


SYMBOL TABLE
  LABEL                             VALUE 

_IDLOC2                           00008002
_IDLOC3                           00008003
_LPBOR_OFF                        00003FFF
_LPBOR_ON                         000037FF
_LVP_OFF                          00001FFF
_LVP_ON                           00003FFF
_MCLRE_OFF                        00003FBF
_MCLRE_ON                         00003FFF
_PLLEN_OFF                        00003EFF
_PLLEN_ON                         00003FFF
_PPS1WAY_OFF                      00003FFB
_PPS1WAY_ON                       00003FFF
_PWRTE_OFF                        00003FFF
_PWRTE_ON                         00003FDF
_STVREN_OFF                       00003DFF
_STVREN_ON                        00003FFF
_WDTE_NSLEEP                      00003FF7
_WDTE_OFF                         00003FE7
_WDTE_ON                          00003FFF
_WDTE_SWDTEN                      00003FEF
_WRT_ALL                          00003FFC
_WRT_BOOT                         00003FFE
_WRT_HALF                         00003FFD
_WRT_OFF                          00003FFF
_ZCDDIS_OFF                       00003F7F
_ZCDDIS_ON                        00003FFF
__16F1703                         00000001
add_time                          00000086
alarm                             000000CA
alarm_disable                     
alarm_loop                        000000D4
attack                            000000FF
beep                              00000098
boite_a_musique                   000001EC
bon_tabac                         00000409
cancellation                      000000C1
case                              
ce3k                              0000028D
claire_fontaine                   00000375
decay                             0000010D
delay                             0000014E
disable_timer                     00000024
disp_test                         000001D3
display_disable                   
display_enable                    
div15                             0000016D
div15_1                           00000179
div15_2                           00000180
div15_3                           00000187
div15_4                           0000018E
div15_exit                        00000193
drop                              
dup                               
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 46


SYMBOL TABLE
  LABEL                             VALUE 

duree                             0000028D
eveil_normal                      00000063
flags                             00000008
frere_jacques                     000003C8
greensleeves                      00000499
gstq                              00000446
hymne_joie                        000002A1
infusion                          0000009E
init                              00000029
isr                               00000004
isr_exit                          00000028
isr_timer0                        0000001E
isr_timer1                        0000000D
joue                              0000023D
last_pos                          0000000A
light_segment                     0000011E
main                              00000054
melodia                           0000031E
msec4                             00000006
musique                           0000000E
musique_0                         00000239
musique_1                         00000234
musique_2                         0000022F
musique_3                         0000022A
musique_4                         00000225
musique_5                         00000220
musique_6                         0000021B
musique_7                         00000216
musique_8                         00000211
no_incr                           000001BB
notes_loop                        0000023F
over                              
pause_msec                        000001AE
popw                              
pushw                             
pwm_loop                          000000B5
pwm_period                        00000007
rand                              000001B2
rseed                             0000000B
rst                               00000000
secondes                          00000005
self_test                         000001CF
servo_pos                         00000131
servo_pos_exit                    0000015F
servo_pos_loop                    00000144
servo_test                        000001E7
soldomi                           0000029A
stack                             00000000
start_msec4_tmr                   000001A5
start_timer                       00000195
sustain                           0000010A
swap                              
temp                              00000009
MPASM 5.70                           MAT.ASM   11-22-2016  14:15:25         PAGE 47


SYMBOL TABLE
  LABEL                             VALUE 

test_tmr1                         00000008
timeout                           000000C4
timeset                           00000072
timeset_exit                      0000008E
timeset_wait_btn                  00000075
tone                              000000E5
tone_end                          00000117
tone_test                         000001E2
trempage                          00000004
wait_loop                         000000A4

Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :    62 reported,     0 suppressed

